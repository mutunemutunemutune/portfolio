import{r as M,j as B}from"./react-DsfxBZ5j.js";import{R as $e,O as Ve,P as Xe,S as Ye,a as ae,V as Ke,b as Je,B as Qe,N as Ze,A as et,W as tt,C as nt,c as oe,d as rt,e as ot,L as le,f as it,U as st,T as at}from"./three-BC_b6VJQ.js";import{j as lt}from"./react-use-measure-chiiXSjK.js";import{F as ct,u as ut}from"./its-fine-DvPcOu7d.js";import{c as K,R as ft}from"./react-reconciler-DczCs7g1.js";import"./react-dom-DNT2GsUc.js";import{_ as xe}from"./@babel-CF3RwP-h.js";import{T as dt,p as pt}from"./troika-three-text-JiH5wS2c.js";import{s as vt}from"./suspend-react-DF1CRDJi.js";var Jt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Zt(e){if(e.__esModule)return e;var n=e.default;if(typeof n=="function"){var o=function i(){return this instanceof i?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};o.prototype=n.prototype}else o={};return Object.defineProperty(o,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var a=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(o,i,a.get?a:{enumerable:!0,get:function(){return e[i]}})}),o}function ht(e){let n;const o=new Set,i=(p,t)=>{const r=typeof p=="function"?p(n):p;if(r!==n){const s=n;n=t?r:Object.assign({},n,r),o.forEach(c=>c(n,s))}},a=()=>n,v=(p,t=a,r=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let s=t(n);function c(){const l=t(n);if(!r(s,l)){const _=s;p(s=l,_)}}return o.add(c),()=>o.delete(c)},d={setState:i,getState:a,subscribe:(p,t,r)=>t||r?v(p,t,r):(o.add(p),()=>o.delete(p)),destroy:()=>o.clear()};return n=e(i,a,d),d}const mt=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),_e=mt?M.useEffect:M.useLayoutEffect;function gt(e){const n=typeof e=="function"?ht(e):e,o=(i=n.getState,a=Object.is)=>{const[,v]=M.useReducer(g=>g+1,0),b=n.getState(),h=M.useRef(b),d=M.useRef(i),p=M.useRef(a),t=M.useRef(!1),r=M.useRef();r.current===void 0&&(r.current=i(b));let s,c=!1;(h.current!==b||d.current!==i||p.current!==a||t.current)&&(s=i(b),c=!a(r.current,s)),_e(()=>{c&&(r.current=s),h.current=b,d.current=i,p.current=a,t.current=!1});const l=M.useRef(b);_e(()=>{const g=()=>{try{const f=n.getState(),y=d.current(f);p.current(r.current,y)||(h.current=f,r.current=y,v())}catch{t.current=!0,v()}},u=n.subscribe(g);return n.getState()!==l.current&&g(),u},[]);const _=c?s:r.current;return M.useDebugValue(_),_};return Object.assign(o,n),o[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[o,n];return{next(){const a=i.length<=0;return{value:i.shift(),done:a}}}},o}var ke={exports:{}},De={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function n(m,E){var w=m.length;m.push(E);e:for(;0<w;){var C=w-1>>>1,D=m[C];if(0<a(D,E))m[C]=E,m[w]=D,w=C;else break e}}function o(m){return m.length===0?null:m[0]}function i(m){if(m.length===0)return null;var E=m[0],w=m.pop();if(w!==E){m[0]=w;e:for(var C=0,D=m.length,L=D>>>1;C<L;){var F=2*(C+1)-1,G=m[F],q=F+1,te=m[q];if(0>a(G,w))q<D&&0>a(te,G)?(m[C]=te,m[q]=w,C=q):(m[C]=G,m[F]=w,C=F);else if(q<D&&0>a(te,w))m[C]=te,m[q]=w,C=q;else break e}}return E}function a(m,E){var w=m.sortIndex-E.sortIndex;return w!==0?w:m.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var v=performance;e.unstable_now=function(){return v.now()}}else{var b=Date,h=b.now();e.unstable_now=function(){return b.now()-h}}var d=[],p=[],t=1,r=null,s=3,c=!1,l=!1,_=!1,g=typeof setTimeout=="function"?setTimeout:null,u=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(m){for(var E=o(p);E!==null;){if(E.callback===null)i(p);else if(E.startTime<=m)i(p),E.sortIndex=E.expirationTime,n(d,E);else break;E=o(p)}}function P(m){if(_=!1,y(m),!l)if(o(d)!==null)l=!0,H(R);else{var E=o(p);E!==null&&U(P,E.startTime-m)}}function R(m,E){l=!1,_&&(_=!1,u(x),x=-1),c=!0;var w=s;try{for(y(E),r=o(d);r!==null&&(!(r.expirationTime>E)||m&&!S());){var C=r.callback;if(typeof C=="function"){r.callback=null,s=r.priorityLevel;var D=C(r.expirationTime<=E);E=e.unstable_now(),typeof D=="function"?r.callback=D:r===o(d)&&i(d),y(E)}else i(d);r=o(d)}if(r!==null)var L=!0;else{var F=o(p);F!==null&&U(P,F.startTime-E),L=!1}return L}finally{r=null,s=w,c=!1}}var j=!1,T=null,x=-1,A=5,k=-1;function S(){return!(e.unstable_now()-k<A)}function O(){if(T!==null){var m=e.unstable_now();k=m;var E=!0;try{E=T(!0,m)}finally{E?z():(j=!1,T=null)}}else j=!1}var z;if(typeof f=="function")z=function(){f(O)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,W=N.port2;N.port1.onmessage=O,z=function(){W.postMessage(null)}}else z=function(){g(O,0)};function H(m){T=m,j||(j=!0,z())}function U(m,E){x=g(function(){m(e.unstable_now())},E)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(m){m.callback=null},e.unstable_continueExecution=function(){l||c||(l=!0,H(R))},e.unstable_forceFrameRate=function(m){0>m||125<m?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<m?Math.floor(1e3/m):5},e.unstable_getCurrentPriorityLevel=function(){return s},e.unstable_getFirstCallbackNode=function(){return o(d)},e.unstable_next=function(m){switch(s){case 1:case 2:case 3:var E=3;break;default:E=s}var w=s;s=E;try{return m()}finally{s=w}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(m,E){switch(m){case 1:case 2:case 3:case 4:case 5:break;default:m=3}var w=s;s=m;try{return E()}finally{s=w}},e.unstable_scheduleCallback=function(m,E,w){var C=e.unstable_now();switch(typeof w=="object"&&w!==null?(w=w.delay,w=typeof w=="number"&&0<w?C+w:C):w=C,m){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=w+D,m={id:t++,callback:E,priorityLevel:m,startTime:w,expirationTime:D,sortIndex:-1},w>C?(m.sortIndex=w,n(p,m),o(d)===null&&m===o(p)&&(_?(u(x),x=-1):_=!0,U(P,w-C))):(m.sortIndex=D,n(d,m),l||c||(l=!0,H(R))),m},e.unstable_shouldYield=S,e.unstable_wrapCallback=function(m){var E=s;return function(){var w=s;s=E;try{return m.apply(this,arguments)}finally{s=w}}}})(De);ke.exports=De;var Se=ke.exports;const be={},yt=e=>void Object.assign(be,e);function bt(e,n){function o(t,{args:r=[],attach:s,...c},l){let _=`${t[0].toUpperCase()}${t.slice(1)}`,g;if(t==="primitive"){if(c.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const u=c.object;g=X(u,{type:t,root:l,attach:s,primitive:!0})}else{const u=be[_];if(!u)throw new Error(`R3F: ${_} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(r))throw new Error("R3F: The args prop must be an array!");g=X(new u(...r),{type:t,root:l,attach:s,memoizedProps:{args:r}})}return g.__r3f.attach===void 0&&(g.isBufferGeometry?g.__r3f.attach="geometry":g.isMaterial&&(g.__r3f.attach="material")),_!=="inject"&&fe(g,c),g}function i(t,r){let s=!1;if(r){var c,l;(c=r.__r3f)!=null&&c.attach?ue(t,r,r.__r3f.attach):r.isObject3D&&t.isObject3D&&(t.add(r),s=!0),s||(l=t.__r3f)==null||l.objects.push(r),r.__r3f||X(r,{}),r.__r3f.parent=t,ye(r),Y(r)}}function a(t,r,s){let c=!1;if(r){var l,_;if((l=r.__r3f)!=null&&l.attach)ue(t,r,r.__r3f.attach);else if(r.isObject3D&&t.isObject3D){r.parent=t,r.dispatchEvent({type:"added"}),t.dispatchEvent({type:"childadded",child:r});const g=t.children.filter(f=>f!==r),u=g.indexOf(s);t.children=[...g.slice(0,u),r,...g.slice(u)],c=!0}c||(_=t.__r3f)==null||_.objects.push(r),r.__r3f||X(r,{}),r.__r3f.parent=t,ye(r),Y(r)}}function v(t,r,s=!1){t&&[...t].forEach(c=>b(r,c,s))}function b(t,r,s){if(r){var c,l,_;if(r.__r3f&&(r.__r3f.parent=null),(c=t.__r3f)!=null&&c.objects&&(t.__r3f.objects=t.__r3f.objects.filter(P=>P!==r)),(l=r.__r3f)!=null&&l.attach)Re(t,r,r.__r3f.attach);else if(r.isObject3D&&t.isObject3D){var g;t.remove(r),(g=r.__r3f)!=null&&g.root&&Mt(ie(r),r)}const f=(_=r.__r3f)==null?void 0:_.primitive,y=!f&&(s===void 0?r.dispose!==null:s);if(!f){var u;v((u=r.__r3f)==null?void 0:u.objects,r,y),v(r.children,r,y)}if(delete r.__r3f,y&&r.dispose&&r.type!=="Scene"){const P=()=>{try{r.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?Se.unstable_scheduleCallback(Se.unstable_IdlePriority,P):P()}Y(t)}}function h(t,r,s,c){var l;const _=(l=t.__r3f)==null?void 0:l.parent;if(!_)return;const g=o(r,s,t.__r3f.root);if(t.children){for(const u of t.children)u.__r3f&&i(g,u);t.children=t.children.filter(u=>!u.__r3f)}t.__r3f.objects.forEach(u=>i(g,u)),t.__r3f.objects=[],t.__r3f.autoRemovedBeforeAppend||b(_,t),g.parent&&(g.__r3f.autoRemovedBeforeAppend=!0),i(_,g),g.raycast&&g.__r3f.eventCount&&ie(g).getState().internal.interaction.push(g),[c,c.alternate].forEach(u=>{u!==null&&(u.stateNode=g,u.ref&&(typeof u.ref=="function"?u.ref(g):u.ref.current=g))})}const d=()=>{};return{reconciler:ft({createInstance:o,removeChild:b,appendChild:i,appendInitialChild:i,insertBefore:a,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(t,r)=>{if(!r)return;const s=t.getState().scene;s.__r3f&&(s.__r3f.root=t,i(s,r))},removeChildFromContainer:(t,r)=>{r&&b(t.getState().scene,r)},insertInContainerBefore:(t,r,s)=>{if(!r||!s)return;const c=t.getState().scene;c.__r3f&&a(c,r,s)},getRootHostContext:()=>null,getChildHostContext:t=>t,finalizeInitialChildren(t){var r;return!!((r=t==null?void 0:t.__r3f)!=null?r:{}).handlers},prepareUpdate(t,r,s,c){var l;if(((l=t==null?void 0:t.__r3f)!=null?l:{}).primitive&&c.object&&c.object!==t)return[!0];{const{args:g=[],children:u,...f}=c,{args:y=[],children:P,...R}=s;if(!Array.isArray(g))throw new Error("R3F: the args prop must be an array!");if(g.some((T,x)=>T!==y[x]))return[!0];const j=He(t,f,R,!0);return j.changes.length?[!1,j]:null}},commitUpdate(t,[r,s],c,l,_,g){r?h(t,c,_,g):fe(t,s)},commitMount(t,r,s,c){var l;const _=(l=t.__r3f)!=null?l:{};t.raycast&&_.handlers&&_.eventCount&&ie(t).getState().internal.interaction.push(t)},getPublicInstance:t=>t,prepareForCommit:()=>null,preparePortalMount:t=>X(t.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(t){var r;const{attach:s,parent:c}=(r=t.__r3f)!=null?r:{};s&&c&&Re(c,t,s),t.isObject3D&&(t.visible=!1),Y(t)},unhideInstance(t,r){var s;const{attach:c,parent:l}=(s=t.__r3f)!=null?s:{};c&&l&&ue(l,t,c),(t.isObject3D&&r.visible==null||r.visible)&&(t.visible=!0),Y(t)},createTextInstance:d,hideTextInstance:d,unhideTextInstance:d,getCurrentEventPriority:()=>n?n():K.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&I.fun(performance.now)?performance.now:I.fun(Date.now)?Date.now:()=>0,scheduleTimeout:I.fun(setTimeout)?setTimeout:void 0,cancelTimeout:I.fun(clearTimeout)?clearTimeout:void 0}),applyProps:fe}}var Ee,Ce;const ce=e=>"colorSpace"in e||"outputColorSpace"in e,Le=()=>{var e;return(e=be.ColorManagement)!=null?e:null},Ae=e=>e&&e.isOrthographicCamera,wt=e=>e&&e.hasOwnProperty("current"),ee=typeof window<"u"&&((Ee=window.document)!=null&&Ee.createElement||((Ce=window.navigator)==null?void 0:Ce.product)==="ReactNative")?M.useLayoutEffect:M.useEffect;function Ie(e){const n=M.useRef(e);return ee(()=>void(n.current=e),[e]),n}function _t({set:e}){return ee(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class ze extends M.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}}ze.getDerivedStateFromError=()=>({error:!0});const Fe="__default",Pe=new Map,St=e=>e&&!!e.memoized&&!!e.changes;function Be(e){var n;const o=typeof window<"u"?(n=window.devicePixelRatio)!=null?n:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],o),e[1]):e}const Q=e=>{var n;return(n=e.__r3f)==null?void 0:n.root.getState()};function ie(e){let n=e.__r3f.root;for(;n.getState().previousRoot;)n=n.getState().previousRoot;return n}const I={obj:e=>e===Object(e)&&!I.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,n,{arrays:o="shallow",objects:i="reference",strict:a=!0}={}){if(typeof e!=typeof n||!!e!=!!n)return!1;if(I.str(e)||I.num(e)||I.boo(e))return e===n;const v=I.obj(e);if(v&&i==="reference")return e===n;const b=I.arr(e);if(b&&o==="reference")return e===n;if((b||v)&&e===n)return!0;let h;for(h in e)if(!(h in n))return!1;if(v&&o==="shallow"&&i==="shallow"){for(h in a?n:e)if(!I.equ(e[h],n[h],{strict:a,objects:"reference"}))return!1}else for(h in a?n:e)if(e[h]!==n[h])return!1;if(I.und(h)){if(b&&e.length===0&&n.length===0||v&&Object.keys(e).length===0&&Object.keys(n).length===0)return!0;if(e!==n)return!1}return!0}};function Et(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const n in e)n.dispose==null||n.dispose(),delete e[n]}function X(e,n){const o=e;return o.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...n},e}function ge(e,n){let o=e;if(n.includes("-")){const i=n.split("-"),a=i.pop();return o=i.reduce((v,b)=>v[b],e),{target:o,key:a}}else return{target:o,key:n}}const Me=/-\d+$/;function ue(e,n,o){if(I.str(o)){if(Me.test(o)){const v=o.replace(Me,""),{target:b,key:h}=ge(e,v);Array.isArray(b[h])||(b[h]=[])}const{target:i,key:a}=ge(e,o);n.__r3f.previousAttach=i[a],i[a]=n}else n.__r3f.previousAttach=o(e,n)}function Re(e,n,o){var i,a;if(I.str(o)){const{target:v,key:b}=ge(e,o),h=n.__r3f.previousAttach;h===void 0?delete v[b]:v[b]=h}else(i=n.__r3f)==null||i.previousAttach==null||i.previousAttach(e,n);(a=n.__r3f)==null||delete a.previousAttach}function He(e,{children:n,key:o,ref:i,...a},{children:v,key:b,ref:h,...d}={},p=!1){const t=e.__r3f,r=Object.entries(a),s=[];if(p){const l=Object.keys(d);for(let _=0;_<l.length;_++)a.hasOwnProperty(l[_])||r.unshift([l[_],Fe+"remove"])}r.forEach(([l,_])=>{var g;if((g=e.__r3f)!=null&&g.primitive&&l==="object"||I.equ(_,d[l]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(l))return s.push([l,_,!0,[]]);let u=[];l.includes("-")&&(u=l.split("-")),s.push([l,_,!1,u]);for(const f in a){const y=a[f];f.startsWith(`${l}-`)&&s.push([f,y,!1,f.split("-")])}});const c={...a};return t!=null&&t.memoizedProps&&t!=null&&t.memoizedProps.args&&(c.args=t.memoizedProps.args),t!=null&&t.memoizedProps&&t!=null&&t.memoizedProps.attach&&(c.attach=t.memoizedProps.attach),{memoized:c,changes:s}}function fe(e,n){var o;const i=e.__r3f,a=i==null?void 0:i.root,v=a==null||a.getState==null?void 0:a.getState(),{memoized:b,changes:h}=St(n)?n:He(e,n),d=i==null?void 0:i.eventCount;e.__r3f&&(e.__r3f.memoizedProps=b);for(let s=0;s<h.length;s++){let[c,l,_,g]=h[s];if(ce(e)){const P="srgb",R="srgb-linear";c==="encoding"?(c="colorSpace",l=l===3001?P:R):c==="outputEncoding"&&(c="outputColorSpace",l=l===3001?P:R)}let u=e,f=u[c];if(g.length&&(f=g.reduce((y,P)=>y[P],e),!(f&&f.set))){const[y,...P]=g.reverse();u=P.reverse().reduce((R,j)=>R[j],e),c=y}if(l===Fe+"remove")if(u.constructor){let y=Pe.get(u.constructor);y||(y=new u.constructor,Pe.set(u.constructor,y)),l=y[c]}else l=0;if(_&&i)l?i.handlers[c]=l:delete i.handlers[c],i.eventCount=Object.keys(i.handlers).length;else if(f&&f.set&&(f.copy||f instanceof le)){if(Array.isArray(l))f.fromArray?f.fromArray(l):f.set(...l);else if(f.copy&&l&&l.constructor&&f.constructor===l.constructor)f.copy(l);else if(l!==void 0){var p;const y=(p=f)==null?void 0:p.isColor;!y&&f.setScalar?f.setScalar(l):f instanceof le&&l instanceof le?f.mask=l.mask:f.set(l),!Le()&&v&&!v.linear&&y&&f.convertSRGBToLinear()}}else{var t;if(u[c]=l,(t=u[c])!=null&&t.isTexture&&u[c].format===it&&u[c].type===st&&v){const y=u[c];ce(y)&&ce(v.gl)?y.colorSpace=v.gl.outputColorSpace:y.encoding=v.gl.outputEncoding}}Y(e)}if(i&&i.parent&&e.raycast&&d!==i.eventCount){const s=ie(e).getState().internal,c=s.interaction.indexOf(e);c>-1&&s.interaction.splice(c,1),i.eventCount&&s.interaction.push(e)}return!(h.length===1&&h[0][0]==="onUpdate")&&h.length&&(o=e.__r3f)!=null&&o.parent&&ye(e),e}function Y(e){var n,o;const i=(n=e.__r3f)==null||(o=n.root)==null||o.getState==null?void 0:o.getState();i&&i.internal.frames===0&&i.invalidate()}function ye(e){e.onUpdate==null||e.onUpdate(e)}function Ct(e,n){e.manual||(Ae(e)?(e.left=n.width/-2,e.right=n.width/2,e.top=n.height/2,e.bottom=n.height/-2):e.aspect=n.width/n.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function ne(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Pt(){var e;const n=typeof self<"u"&&self||typeof window<"u"&&window;if(!n)return K.DefaultEventPriority;switch((e=n.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return K.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return K.ContinuousEventPriority;default:return K.DefaultEventPriority}}function Ne(e,n,o,i){const a=o.get(n);a&&(o.delete(n),o.size===0&&(e.delete(i),a.target.releasePointerCapture(i)))}function Mt(e,n){const{internal:o}=e.getState();o.interaction=o.interaction.filter(i=>i!==n),o.initialHits=o.initialHits.filter(i=>i!==n),o.hovered.forEach((i,a)=>{(i.eventObject===n||i.object===n)&&o.hovered.delete(a)}),o.capturedMap.forEach((i,a)=>{Ne(o.capturedMap,n,i,a)})}function Rt(e){function n(d){const{internal:p}=e.getState(),t=d.offsetX-p.initialClick[0],r=d.offsetY-p.initialClick[1];return Math.round(Math.sqrt(t*t+r*r))}function o(d){return d.filter(p=>["Move","Over","Enter","Out","Leave"].some(t=>{var r;return(r=p.__r3f)==null?void 0:r.handlers["onPointer"+t]}))}function i(d,p){const t=e.getState(),r=new Set,s=[],c=p?p(t.internal.interaction):t.internal.interaction;for(let u=0;u<c.length;u++){const f=Q(c[u]);f&&(f.raycaster.camera=void 0)}t.previousRoot||t.events.compute==null||t.events.compute(d,t);function l(u){const f=Q(u);if(!f||!f.events.enabled||f.raycaster.camera===null)return[];if(f.raycaster.camera===void 0){var y;f.events.compute==null||f.events.compute(d,f,(y=f.previousRoot)==null?void 0:y.getState()),f.raycaster.camera===void 0&&(f.raycaster.camera=null)}return f.raycaster.camera?f.raycaster.intersectObject(u,!0):[]}let _=c.flatMap(l).sort((u,f)=>{const y=Q(u.object),P=Q(f.object);return!y||!P?u.distance-f.distance:P.events.priority-y.events.priority||u.distance-f.distance}).filter(u=>{const f=ne(u);return r.has(f)?!1:(r.add(f),!0)});t.events.filter&&(_=t.events.filter(_,t));for(const u of _){let f=u.object;for(;f;){var g;(g=f.__r3f)!=null&&g.eventCount&&s.push({...u,eventObject:f}),f=f.parent}}if("pointerId"in d&&t.internal.capturedMap.has(d.pointerId))for(let u of t.internal.capturedMap.get(d.pointerId).values())r.has(ne(u.intersection))||s.push(u.intersection);return s}function a(d,p,t,r){const s=e.getState();if(d.length){const c={stopped:!1};for(const l of d){const _=Q(l.object)||s,{raycaster:g,pointer:u,camera:f,internal:y}=_,P=new oe(u.x,u.y,0).unproject(f),R=k=>{var S,O;return(S=(O=y.capturedMap.get(k))==null?void 0:O.has(l.eventObject))!=null?S:!1},j=k=>{const S={intersection:l,target:p.target};y.capturedMap.has(k)?y.capturedMap.get(k).set(l.eventObject,S):y.capturedMap.set(k,new Map([[l.eventObject,S]])),p.target.setPointerCapture(k)},T=k=>{const S=y.capturedMap.get(k);S&&Ne(y.capturedMap,l.eventObject,S,k)};let x={};for(let k in p){let S=p[k];typeof S!="function"&&(x[k]=S)}let A={...l,...x,pointer:u,intersections:d,stopped:c.stopped,delta:t,unprojectedPoint:P,ray:g.ray,camera:f,stopPropagation(){const k="pointerId"in p&&y.capturedMap.get(p.pointerId);if((!k||k.has(l.eventObject))&&(A.stopped=c.stopped=!0,y.hovered.size&&Array.from(y.hovered.values()).find(S=>S.eventObject===l.eventObject))){const S=d.slice(0,d.indexOf(l));v([...S,l])}},target:{hasPointerCapture:R,setPointerCapture:j,releasePointerCapture:T},currentTarget:{hasPointerCapture:R,setPointerCapture:j,releasePointerCapture:T},nativeEvent:p};if(r(A),c.stopped===!0)break}}return d}function v(d){const{internal:p}=e.getState();for(const t of p.hovered.values())if(!d.length||!d.find(r=>r.object===t.object&&r.index===t.index&&r.instanceId===t.instanceId)){const s=t.eventObject.__r3f,c=s==null?void 0:s.handlers;if(p.hovered.delete(ne(t)),s!=null&&s.eventCount){const l={...t,intersections:d};c.onPointerOut==null||c.onPointerOut(l),c.onPointerLeave==null||c.onPointerLeave(l)}}}function b(d,p){for(let t=0;t<p.length;t++){const r=p[t].__r3f;r==null||r.handlers.onPointerMissed==null||r.handlers.onPointerMissed(d)}}function h(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>v([]);case"onLostPointerCapture":return p=>{const{internal:t}=e.getState();"pointerId"in p&&t.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{t.capturedMap.has(p.pointerId)&&(t.capturedMap.delete(p.pointerId),v([]))})}}return function(t){const{onPointerMissed:r,internal:s}=e.getState();s.lastEvent.current=t;const c=d==="onPointerMove",l=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",g=i(t,c?o:void 0),u=l?n(t):0;d==="onPointerDown"&&(s.initialClick=[t.offsetX,t.offsetY],s.initialHits=g.map(y=>y.eventObject)),l&&!g.length&&u<=2&&(b(t,s.interaction),r&&r(t)),c&&v(g);function f(y){const P=y.eventObject,R=P.__r3f,j=R==null?void 0:R.handlers;if(R!=null&&R.eventCount)if(c){if(j.onPointerOver||j.onPointerEnter||j.onPointerOut||j.onPointerLeave){const T=ne(y),x=s.hovered.get(T);x?x.stopped&&y.stopPropagation():(s.hovered.set(T,y),j.onPointerOver==null||j.onPointerOver(y),j.onPointerEnter==null||j.onPointerEnter(y))}j.onPointerMove==null||j.onPointerMove(y)}else{const T=j[d];T?(!l||s.initialHits.includes(P))&&(b(t,s.interaction.filter(x=>!s.initialHits.includes(x))),T(y)):l&&s.initialHits.includes(P)&&b(t,s.interaction.filter(x=>!s.initialHits.includes(x)))}}a(g,t,u,f)}}return{handlePointer:h}}const Ue=e=>!!(e!=null&&e.render),Ge=M.createContext(null),jt=(e,n)=>{const o=gt((h,d)=>{const p=new oe,t=new oe,r=new oe;function s(u=d().camera,f=t,y=d().size){const{width:P,height:R,top:j,left:T}=y,x=P/R;f.isVector3?r.copy(f):r.set(...f);const A=u.getWorldPosition(p).distanceTo(r);if(Ae(u))return{width:P/u.zoom,height:R/u.zoom,top:j,left:T,factor:1,distance:A,aspect:x};{const k=u.fov*Math.PI/180,S=2*Math.tan(k/2)*A,O=S*(P/R);return{width:O,height:S,top:j,left:T,factor:P/O,distance:A,aspect:x}}}let c;const l=u=>h(f=>({performance:{...f.performance,current:u}})),_=new rt;return{set:h,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(u=1)=>e(d(),u),advance:(u,f)=>n(u,f,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new ot,pointer:_,mouse:_,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const u=d();c&&clearTimeout(c),u.performance.current!==u.performance.min&&l(u.performance.min),c=setTimeout(()=>l(d().performance.max),u.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:s},setEvents:u=>h(f=>({...f,events:{...f.events,...u}})),setSize:(u,f,y,P,R)=>{const j=d().camera,T={width:u,height:f,top:P||0,left:R||0,updateStyle:y};h(x=>({size:T,viewport:{...x.viewport,...s(j,t,T)}}))},setDpr:u=>h(f=>{const y=Be(u);return{viewport:{...f.viewport,dpr:y,initialDpr:f.viewport.initialDpr||y}}}),setFrameloop:(u="always")=>{const f=d().clock;f.stop(),f.elapsedTime=0,u!=="never"&&(f.start(),f.elapsedTime=0),h(()=>({frameloop:u}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:M.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(u,f,y)=>{const P=d().internal;return P.priority=P.priority+(f>0?1:0),P.subscribers.push({ref:u,priority:f,store:y}),P.subscribers=P.subscribers.sort((R,j)=>R.priority-j.priority),()=>{const R=d().internal;R!=null&&R.subscribers&&(R.priority=R.priority-(f>0?1:0),R.subscribers=R.subscribers.filter(j=>j.ref!==u))}}}}}),i=o.getState();let a=i.size,v=i.viewport.dpr,b=i.camera;return o.subscribe(()=>{const{camera:h,size:d,viewport:p,gl:t,set:r}=o.getState();if(d.width!==a.width||d.height!==a.height||p.dpr!==v){var s;a=d,v=p.dpr,Ct(h,d),t.setPixelRatio(p.dpr);const c=(s=d.updateStyle)!=null?s:typeof HTMLCanvasElement<"u"&&t.domElement instanceof HTMLCanvasElement;t.setSize(d.width,d.height,c)}h!==b&&(b=h,r(c=>({viewport:{...c.viewport,...c.viewport.getCurrentViewport(h)}})))}),o.subscribe(h=>e(h)),o};let re,Ot=new Set,Tt=new Set,xt=new Set;function de(e,n){if(e.size)for(const{callback:o}of e.values())o(n)}function Z(e,n){switch(e){case"before":return de(Ot,n);case"after":return de(Tt,n);case"tail":return de(xt,n)}}let pe,ve;function he(e,n,o){let i=n.clock.getDelta();for(n.frameloop==="never"&&typeof e=="number"&&(i=e-n.clock.elapsedTime,n.clock.oldTime=n.clock.elapsedTime,n.clock.elapsedTime=e),pe=n.internal.subscribers,re=0;re<pe.length;re++)ve=pe[re],ve.ref.current(ve.store.getState(),i,o);return!n.internal.priority&&n.gl.render&&n.gl.render(n.scene,n.camera),n.internal.frames=Math.max(0,n.internal.frames-1),n.frameloop==="always"?1:n.internal.frames}function kt(e){let n=!1,o=!1,i,a,v;function b(p){a=requestAnimationFrame(b),n=!0,i=0,Z("before",p),o=!0;for(const r of e.values()){var t;v=r.store.getState(),v.internal.active&&(v.frameloop==="always"||v.internal.frames>0)&&!((t=v.gl.xr)!=null&&t.isPresenting)&&(i+=he(p,v))}if(o=!1,Z("after",p),i===0)return Z("tail",p),n=!1,cancelAnimationFrame(a)}function h(p,t=1){var r;if(!p)return e.forEach(s=>h(s.store.getState(),t));(r=p.gl.xr)!=null&&r.isPresenting||!p.internal.active||p.frameloop==="never"||(t>1?p.internal.frames=Math.min(60,p.internal.frames+t):o?p.internal.frames=2:p.internal.frames=1,n||(n=!0,requestAnimationFrame(b)))}function d(p,t=!0,r,s){if(t&&Z("before",p),r)he(p,r,s);else for(const c of e.values())he(p,c.store.getState());t&&Z("after",p)}return{loop:b,invalidate:h,advance:d}}function qe(){const e=M.useContext(Ge);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function Dt(e=o=>o,n){return qe()(e,n)}function en(e,n=0){const o=qe(),i=o.getState().internal.subscribe,a=Ie(e);return ee(()=>i(a,n,o),[n,i,o]),null}const J=new Map,{invalidate:je,advance:Oe}=kt(J),{reconciler:se,applyProps:$}=bt(J,Pt),V={objects:"shallow",strict:!1},Lt=(e,n)=>{const o=typeof e=="function"?e(n):e;return Ue(o)?o:new tt({powerPreference:"high-performance",canvas:n,antialias:!0,alpha:!0,...e})};function At(e,n){const o=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(n){const{width:i,height:a,top:v,left:b,updateStyle:h=o}=n;return{width:i,height:a,top:v,left:b,updateStyle:h}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:i,height:a,top:v,left:b}=e.parentElement.getBoundingClientRect();return{width:i,height:a,top:v,left:b,updateStyle:o}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:o};return{width:0,height:0,top:0,left:0}}function It(e){const n=J.get(e),o=n==null?void 0:n.fiber,i=n==null?void 0:n.store;n&&console.warn("R3F.createRoot should only be called once!");const a=typeof reportError=="function"?reportError:console.error,v=i||jt(je,Oe),b=o||se.createContainer(v,K.ConcurrentRoot,null,!1,null,"",a,null);n||J.set(e,{fiber:b,store:v});let h,d=!1,p;return{configure(t={}){let{gl:r,size:s,scene:c,events:l,onCreated:_,shadows:g=!1,linear:u=!1,flat:f=!1,legacy:y=!1,orthographic:P=!1,frameloop:R="always",dpr:j=[1,2],performance:T,raycaster:x,camera:A,onPointerMissed:k}=t,S=v.getState(),O=S.gl;S.gl||S.set({gl:O=Lt(r,e)});let z=S.raycaster;z||S.set({raycaster:z=new $e});const{params:N,...W}=x||{};if(I.equ(W,z,V)||$(z,{...W}),I.equ(N,z.params,V)||$(z,{params:{...z.params,...N}}),!S.camera||S.camera===p&&!I.equ(p,A,V)){p=A;const w=A instanceof nt,C=w?A:P?new Ve(0,0,0,0,.1,1e3):new Xe(75,0,.1,1e3);w||(C.position.z=5,A&&($(C,A),("aspect"in A||"left"in A||"right"in A||"bottom"in A||"top"in A)&&(C.manual=!0,C.updateProjectionMatrix())),!S.camera&&!(A!=null&&A.rotation)&&C.lookAt(0,0,0)),S.set({camera:C}),z.camera=C}if(!S.scene){let w;c!=null&&c.isScene?w=c:(w=new Ye,c&&$(w,c)),S.set({scene:X(w)})}if(!S.xr){var H;const w=(L,F)=>{const G=v.getState();G.frameloop!=="never"&&Oe(L,!0,G,F)},C=()=>{const L=v.getState();L.gl.xr.enabled=L.gl.xr.isPresenting,L.gl.xr.setAnimationLoop(L.gl.xr.isPresenting?w:null),L.gl.xr.isPresenting||je(L)},D={connect(){const L=v.getState().gl;L.xr.addEventListener("sessionstart",C),L.xr.addEventListener("sessionend",C)},disconnect(){const L=v.getState().gl;L.xr.removeEventListener("sessionstart",C),L.xr.removeEventListener("sessionend",C)}};typeof((H=O.xr)==null?void 0:H.addEventListener)=="function"&&D.connect(),S.set({xr:D})}if(O.shadowMap){const w=O.shadowMap.enabled,C=O.shadowMap.type;if(O.shadowMap.enabled=!!g,I.boo(g))O.shadowMap.type=ae;else if(I.str(g)){var U;const D={basic:Qe,percentage:Je,soft:ae,variance:Ke};O.shadowMap.type=(U=D[g])!=null?U:ae}else I.obj(g)&&Object.assign(O.shadowMap,g);(w!==O.shadowMap.enabled||C!==O.shadowMap.type)&&(O.shadowMap.needsUpdate=!0)}const m=Le();m&&("enabled"in m?m.enabled=!y:"legacyMode"in m&&(m.legacyMode=y)),d||$(O,{outputEncoding:u?3e3:3001,toneMapping:f?Ze:et}),S.legacy!==y&&S.set(()=>({legacy:y})),S.linear!==u&&S.set(()=>({linear:u})),S.flat!==f&&S.set(()=>({flat:f})),r&&!I.fun(r)&&!Ue(r)&&!I.equ(r,O,V)&&$(O,r),l&&!S.events.handlers&&S.set({events:l(v)});const E=At(e,s);return I.equ(E,S.size,V)||S.setSize(E.width,E.height,E.updateStyle,E.top,E.left),j&&S.viewport.dpr!==Be(j)&&S.setDpr(j),S.frameloop!==R&&S.setFrameloop(R),S.onPointerMissed||S.set({onPointerMissed:k}),T&&!I.equ(T,S.performance,V)&&S.set(w=>({performance:{...w.performance,...T}})),h=_,d=!0,this},render(t){return d||this.configure(),se.updateContainer(B.jsx(zt,{store:v,children:t,onCreated:h,rootElement:e}),b,null,()=>{}),v},unmount(){We(e)}}}function zt({store:e,children:n,onCreated:o,rootElement:i}){return ee(()=>{const a=e.getState();a.set(v=>({internal:{...v.internal,active:!0}})),o&&o(a),e.getState().events.connected||a.events.connect==null||a.events.connect(i)},[]),B.jsx(Ge.Provider,{value:e,children:n})}function We(e,n){const o=J.get(e),i=o==null?void 0:o.fiber;if(i){const a=o==null?void 0:o.store.getState();a&&(a.internal.active=!1),se.updateContainer(null,i,null,()=>{a&&setTimeout(()=>{try{var v,b,h,d;a.events.disconnect==null||a.events.disconnect(),(v=a.gl)==null||(b=v.renderLists)==null||b.dispose==null||b.dispose(),(h=a.gl)==null||h.forceContextLoss==null||h.forceContextLoss(),(d=a.gl)!=null&&d.xr&&a.xr.disconnect(),Et(a),J.delete(e)}catch{}},500)})}}se.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:M.version});const me={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Ft(e){const{handlePointer:n}=Rt(e);return{priority:1,enabled:!0,compute(o,i,a){i.pointer.set(o.offsetX/i.size.width*2-1,-(o.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(me).reduce((o,i)=>({...o,[i]:n(i)}),{}),update:()=>{var o;const{events:i,internal:a}=e.getState();(o=a.lastEvent)!=null&&o.current&&i.handlers&&i.handlers.onPointerMove(a.lastEvent.current)},connect:o=>{var i;const{set:a,events:v}=e.getState();v.disconnect==null||v.disconnect(),a(b=>({events:{...b.events,connected:o}})),Object.entries((i=v.handlers)!=null?i:[]).forEach(([b,h])=>{const[d,p]=me[b];o.addEventListener(d,h,{passive:p})})},disconnect:()=>{const{set:o,events:i}=e.getState();if(i.connected){var a;Object.entries((a=i.handlers)!=null?a:[]).forEach(([v,b])=>{if(i&&i.connected instanceof HTMLElement){const[h]=me[v];i.connected.removeEventListener(h,b)}}),o(v=>({events:{...v.events,connected:void 0}}))}}}}const Bt=M.forwardRef(function({children:n,fallback:o,resize:i,style:a,gl:v,events:b=Ft,eventSource:h,eventPrefix:d,shadows:p,linear:t,flat:r,legacy:s,orthographic:c,frameloop:l,dpr:_,performance:g,raycaster:u,camera:f,scene:y,onPointerMissed:P,onCreated:R,...j},T){M.useMemo(()=>yt(at),[]);const x=ut(),[A,k]=lt({scroll:!0,debounce:{scroll:50,resize:0},...i}),S=M.useRef(null),O=M.useRef(null);M.useImperativeHandle(T,()=>S.current);const z=Ie(P),[N,W]=M.useState(!1),[H,U]=M.useState(!1);if(N)throw N;if(H)throw H;const m=M.useRef(null);ee(()=>{const w=S.current;k.width>0&&k.height>0&&w&&(m.current||(m.current=It(w)),m.current.configure({gl:v,events:b,shadows:p,linear:t,flat:r,legacy:s,orthographic:c,frameloop:l,dpr:_,performance:g,raycaster:u,camera:f,scene:y,size:k,onPointerMissed:(...C)=>z.current==null?void 0:z.current(...C),onCreated:C=>{C.events.connect==null||C.events.connect(h?wt(h)?h.current:h:O.current),d&&C.setEvents({compute:(D,L)=>{const F=D[d+"X"],G=D[d+"Y"];L.pointer.set(F/L.size.width*2-1,-(G/L.size.height)*2+1),L.raycaster.setFromCamera(L.pointer,L.camera)}}),R==null||R(C)}}),m.current.render(B.jsx(x,{children:B.jsx(ze,{set:U,children:B.jsx(M.Suspense,{fallback:B.jsx(_t,{set:W}),children:n??null})})})))}),M.useEffect(()=>{const w=S.current;if(w)return()=>We(w)},[]);const E=h?"none":"auto";return B.jsx("div",{ref:O,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:E,...a},...j,children:B.jsx("div",{ref:A,style:{width:"100%",height:"100%"},children:B.jsx("canvas",{ref:S,style:{display:"block"},children:o})})})}),tn=M.forwardRef(function(n,o){return B.jsx(ct,{children:B.jsx(Bt,{...n,ref:o})})}),nn=M.forwardRef(({sdfGlyphSize:e=64,anchorX:n="center",anchorY:o="middle",font:i,fontSize:a=1,children:v,characters:b,onSync:h,...d},p)=>{const t=Dt(({invalidate:l})=>l),[r]=M.useState(()=>new dt),[s,c]=M.useMemo(()=>{const l=[];let _="";return M.Children.forEach(v,g=>{typeof g=="string"||typeof g=="number"?_+=g:l.push(g)}),[l,_]},[v]);return vt(()=>new Promise(l=>pt({font:i,characters:b},l)),["troika-text",i,b]),M.useLayoutEffect(()=>void r.sync(()=>{t(),h&&h(r)})),M.useEffect(()=>()=>r.dispose(),[r]),M.createElement("primitive",xe({object:r,ref:p,font:i,text:c,anchorX:n,anchorY:o,fontSize:a,sdfGlyphSize:e},d),s)}),Ht="modulepreload",Nt=function(e){return"/"+e},Te={},rn=function(n,o,i){return!o||o.length===0?n():(document.getElementsByTagName("link"),Promise.all(o.map(a=>{if(a=Nt(a),a in Te)return;Te[a]=!0;const v=a.endsWith(".css"),b=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${b}`))return;const h=document.createElement("link");if(h.rel=v?"stylesheet":Ht,v||(h.as="script",h.crossOrigin=""),h.href=a,document.head.appendChild(h),v)return new Promise((d,p)=>{h.addEventListener("load",d),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>n()).catch(a=>{const v=new Event("vite:preloadError",{cancelable:!0});if(v.payload=a,window.dispatchEvent(v),!v.defaultPrevented)throw a}))};function we(e,n){const o=e+"Geometry";return M.forwardRef(({args:i,children:a,...v},b)=>{const h=M.useRef(null);return M.useImperativeHandle(b,()=>h.current),M.useLayoutEffect(()=>void(n==null?void 0:n(h.current))),M.createElement("mesh",xe({ref:h},v),M.createElement(o,{attach:"geometry",args:i}),a)})}const on=we("box"),sn=we("sphere"),an=we("torus");export{on as B,tn as C,sn as S,an as T,rn as _,Qt as a,nn as b,Jt as c,Zt as g,en as u};
